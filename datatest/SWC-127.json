{
    "id": "SWC-127",
    "description": [
        "Solidity supports function types. That is, a variable of function type can be assigned with a reference to a function with a matching signature. The function saved to such variable can be called just like a regular function.",
        "The problem arises when a user has the ability to arbitrarily change the function type variable and thus execute random code instructions. As Solidity doesn't support pointer arithmetics, it's impossible to change such variable to an arbitrary value. However, if the developer uses assembly instructions, such asmstoreor assign operator, in the worst case scenario an attacker is able to point a function type variable to any code instruction, violating required validations and required state changes."
    ],
    "FunctionTypes.sol": "/*\n * @source: https://gist.github.com/wadeAlexC/7a18de852693b3f890560ab6a211a2b8\n * @author: Alexander Wade\n */\n\npragma solidity ^0.4.25;\n\ncontract FunctionTypes {\n\n constructor() public payable { require(msg.value != 0); }\n\n function withdraw() private {\n require(msg.value == 0, 'dont send funds!');\n address(msg.sender).transfer(address(this).balance);\n }\n\n function frwd() internal\n { withdraw(); }\n\n struct Func { function () internal f; }\n\n function breakIt() public payable {\n require(msg.value != 0, 'send funds!');\n Func memory func;\n func.f = frwd;\n assembly { mstore(func, add(mload(func), callvalue)) }\n func.f();\n }\n}\n",
    "FunctionTypes_Fixed.sol": "/*\n * @source: https://gist.github.com/wadeAlexC/7a18de852693b3f890560ab6a211a2b8\n * @author: Alexander Wade\n */\n\npragma solidity ^0.4.25;\n\ncontract FunctionTypes {\n\n constructor() public payable { require(msg.value != 0); }\n\n function withdraw() private {\n require(msg.value == 0, 'dont send funds!');\n address(msg.sender).transfer(address(this).balance);\n }\n\n function frwd() internal { withdraw(); }\n\n struct Func { function () internal f; }\n\n function breakIt() public payable {\n require(msg.value != 0, 'send funds!');\n Func memory func;\n func.f = frwd;\n // Removed unsafe assembly code\n func.f();\n }\n}\n"
}